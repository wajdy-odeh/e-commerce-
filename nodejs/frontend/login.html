<!DOCTYPE html>
<html lang="en">
 <heade>
   <title>login</title>
   <meta charset="UTF-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <script src="https://accounts.google.com/gsi/client" async defer></script>
   <script src="./scripts/login.js" async defer></script>
   <link rel="stylesheet" href="./static/auth.css">
 </heade>

 <body>
  <section class = "left-sec-log-page">
    <div class = "illstrati-div-cont">
      <div class = "illst-cicle-form"></div>
    </div>
  </section>

  <section class = "right-sec-log-page">

    <div class = "title-text-cont">
      <p class ="tit-stor-ho">Wellcome to WY STORE</p>
    </div>

   <div class = "login-cont-form">

    <div clas = "log-with-g-for">

      <div id="buttonDiv"></div>

      <div class ="text-in-line">
        <div class="line-div-for-text"></div>
          <p>or</p>
        <div class="line-div-for-text"></div>
      </div>
   </div>

    <div class = "cont-login-form">
      <input placeholder="Enter your email here" class = "us-info-log-inpu" id = "log-email-input" type="email"/>
      <input placeholder="Enter your password here"class = "us-info-log-inpu" id = "log-pass-input" type="password"/>
      <a href="#" class = "do-ha-acco-hre">forget password ?</a>
      <button  class = "submit-button" onclick="authonticate()">Login</button>
      <a href="#" class = "do-ha-acco-hre">don't have account?</a>
      <a href="#" onclick="signOut();">Sign out</a>
    </div>
  </div>

  </section>
  <script>
    function handleCredentialResponse(response) {
      console.log("Encoded JWT ID token: " + response.credential);
      fetch('http://127.0.0.1:5000/api/v1/users/g_auth0' , {method:'POST',headers:{'g-auth-token-id':response.credential},credentials: 'same-origin'}).then(res=>{
        return res.json()
      }).then(res =>{
        const d = new Date()
        let expireDate = d.setDate(d.getDate() + 24 * 60 * 60 * 1000);
        expireDate = d.toUTCString() 
        console.log(expireDate)
        document.cookie = `session_key=${res.session_key},expires=${expireDate}`
      })
      .catch(err=>console.log(err))
    }
    window.onload = function () {
      google.accounts.id.initialize({
        client_id: "591903598674-26jd621j2c2joi3m4obtedtnsd3vj2p9.apps.googleusercontent.com",
        callback: handleCredentialResponse
      });
      google.accounts.id.renderButton(
        document.getElementById("buttonDiv"),
        { theme: "outline", size: "large" }  // customization attributes
      );
      google.accounts.id.prompt(); // also display the One Tap dialog
    }
</script>
 </body>
</html>
